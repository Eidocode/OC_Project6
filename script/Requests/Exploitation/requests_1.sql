-- --------------------------------------------------
-- Sélectionner tous les employés d'un restaurant
-- --------------------------------------------------

SELECT 
    user.title AS "Title", user.lastname AS "Lastname", user.firstname AS "Firstname", 
    role.role AS "Role", restaurant.name AS "Restaurant"
FROM 
    employee
INNER JOIN user ON 
    user.id = employee.user_id
INNER JOIN role ON 
    role.id = employee.role_id
INNER JOIN restaurant ON 
    restaurant.id = employee.restaurant_id
WHERE 
    restaurant.id = 1
ORDER BY 
    role.id;

-- --------------------------------------------------------------------
-- Sélectionner les noms, prénoms, login de tous les comptes Customer
-- --------------------------------------------------------------------

SELECT 
    user.firstname AS "Firstname", user.lastname AS "Lastname", user.login AS "Login"
FROM 
    customer
INNER JOIN user ON 
    user.id = customer.user_id

-- ----------------------------------------------------------------------
-- Voir si un client a une commande en livraison et quel est son statut
-- ----------------------------------------------------------------------

SELECT 
    `order`.number AS "# Order", `order`.delivery AS "Delivery", user.firstname AS "Firstname", 
    user.lastname AS "Lastname", state.order_state AS "Order state"
FROM 
    `order`
INNER JOIN customer ON 
    customer.id = `order`.`customer_id`
INNER JOIN user ON 
    user.id = customer.user_id
INNER JOIN state ON 
    state.id = `order`.`state_id`
WHERE 
    `order`.`delivery` = 1
ORDER BY 
    state.id

-- -----------------------------------------------------------
-- Sélectionner le stock d'olives dans un restaurant donné
-- -----------------------------------------------------------

SELECT 
    ingredient.name AS "Ingredient", stock.quantity AS "Qty (gr.)", restaurant.name AS "Restaurant"
FROM 
    stock
INNER JOIN ingredient ON 
    ingredient.id = stock.ingredient_id
INNER JOIN restaurant ON 
    restaurant.id = stock.restaurant_id
WHERE 
    ingredient.name = "olive" 
AND 
    restaurant.id = 5

-- --------------------------------------
-- Rechercher la recette d'un article
-- --------------------------------------

SELECT 
    pizza.name AS "Pizza", reminder.name AS "Title", 
    reminder.description AS "Recipe"
FROM 
    reminder 
INNER JOIN pizza ON 
    pizza.id = reminder.pizza_id 
WHERE 
    pizza.name = "Gourmande";

-- -------------------------------------------------------
-- Rechercher le prix hors taxe d'un article en commande
-- -------------------------------------------------------

SELECT 
    `order`.number AS "# Order", pizza.name AS "Pizza", pizza.unit_price_ht AS "Unit Price HT"
FROM 
    item
INNER JOIN `order` ON 
    `order`.number = item.order_number
INNER JOIN pizza ON 
    pizza.id = item.pizza_id
WHERE 
    `order`.number = 68

-- ---------------------------------------------------------------------------
-- Rechercher l'adresse d'une facture/commande qui n'a pas été payé
-- ---------------------------------------------------------------------------

SELECT 
    `order`.number AS "# Order", user.lastname AS "Lastname", user.firstname AS "Firstname", 
    contact.street_number AS "# Street", contact.street_name AS "Street name" , 
    contact.postal_code AS "Postal code", contact.city AS "City", payment_type.type AS "Payment type"
FROM 
    `order`
INNER JOIN customer ON 
    customer.id = `order`.customer_id
INNER JOIN user ON 
    user.id = customer.user_id
INNER JOIN contact ON 
    contact.id = customer.contact_id
INNER JOIN bill ON 
    bill.order_number = `order`.number
INNER JOIN payment_type ON 
    payment_type.id = bill.payment_type_id
WHERE 
    payment_type.id = 4 
AND
    `order`.number = 19;

-- -------------------------------------------------------------------------
-- Rechercher l'adresse de livraison d'une commande en cours de livraison
-- -------------------------------------------------------------------------

SELECT 
    `order`.number AS "# Order", contact.street_number AS "# Street", 
    contact.street_name AS "Street name", contact.postal_code AS "Postal code", 
    contact.city "City", state.order_state AS "Order state"
FROM 
    `order`
INNER JOIN customer ON 
    customer.id = `order`.customer_id
INNER JOIN contact ON 
    contact.id = customer.contact_id
INNER JOIN state ON 
    state.id = `order`.state_id
WHERE 
    `order`.delivery = 1 
AND 
    state.id = 4

-- --------------------------------------------------------------
-- Retrouver l'intitulé de profession d'un membre du personnel
-- --------------------------------------------------------------

SELECT 
    user.lastname AS "Lastname", user.firstname AS "Firstname", role.role AS "Role"
FROM 
    employee
INNER JOIN user ON 
    user.id = employee.user_id
INNER JOIN role ON 
    role.id = employee.role_id
WHERE 
    user.login = "ryglou"

-- --------------------------------------------------------------
-- Rechercher la quantité donnée d'un ingrédient pour une recette
-- --------------------------------------------------------------

SELECT 
    reminder.name AS "Title", reminder.description AS "Recipe", 
    ingredient.name AS "Ingredient", pizza_ingredient.quantity AS "Qty (gr.)"
FROM 
    pizza 
INNER JOIN reminder ON 
    reminder.pizza_id = pizza.id 
INNER JOIN pizza_ingredient ON 
    pizza_ingredient.pizza_id = pizza.id 
INNER JOIN ingredient ON 
    ingredient.id = pizza_ingredient.ingredient_id  
WHERE 
    pizza.name = "Royale" 
AND 
    ingredient.name = "Merguez";